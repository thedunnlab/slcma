<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Andrew Smith" />


<title>Examples demonstrating slcma R functions v0.5.R</title>


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link href="data:text/css,body%20%7B%0A%20%20background%2Dcolor%3A%20%23fff%3B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20max%2Dwidth%3A%20700px%3B%0A%20%20overflow%3A%20visible%3B%0A%20%20padding%2Dleft%3A%202em%3B%0A%20%20padding%2Dright%3A%202em%3B%0A%20%20font%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0A%20%20font%2Dsize%3A%2014px%3B%0A%20%20line%2Dheight%3A%201%2E35%3B%0A%7D%0A%0A%23TOC%20%7B%0A%20%20clear%3A%20both%3B%0A%20%20margin%3A%200%200%2010px%2010px%3B%0A%20%20padding%3A%204px%3B%0A%20%20width%3A%20400px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20border%2Dradius%3A%205px%3B%0A%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20font%2Dsize%3A%2013px%3B%0A%20%20line%2Dheight%3A%201%2E3%3B%0A%7D%0A%20%20%23TOC%20%2Etoctitle%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%20%20font%2Dsize%3A%2015px%3B%0A%20%20%20%20margin%2Dleft%3A%205px%3B%0A%20%20%7D%0A%0A%20%20%23TOC%20ul%20%7B%0A%20%20%20%20padding%2Dleft%3A%2040px%3B%0A%20%20%20%20margin%2Dleft%3A%20%2D1%2E5em%3B%0A%20%20%20%20margin%2Dtop%3A%205px%3B%0A%20%20%20%20margin%2Dbottom%3A%205px%3B%0A%20%20%7D%0A%20%20%23TOC%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dleft%3A%20%2D2em%3B%0A%20%20%7D%0A%20%20%23TOC%20li%20%7B%0A%20%20%20%20line%2Dheight%3A%2016px%3B%0A%20%20%7D%0A%0Atable%20%7B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dcolor%3A%20%23DDDDDD%3B%0A%20%20border%2Dstyle%3A%20outset%3B%0A%20%20border%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0A%20%20border%2Dwidth%3A%202px%3B%0A%20%20padding%3A%205px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%20%20line%2Dheight%3A%2018px%3B%0A%20%20padding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0A%20%20border%2Dleft%2Dstyle%3A%20none%3B%0A%20%20border%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Ap%20%7B%0A%20%20margin%3A%200%2E5em%200%3B%0A%7D%0A%0Ablockquote%20%7B%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20padding%3A%200%2E25em%200%2E75em%3B%0A%7D%0A%0Ahr%20%7B%0A%20%20border%2Dstyle%3A%20solid%3B%0A%20%20border%3A%20none%3B%0A%20%20border%2Dtop%3A%201px%20solid%20%23777%3B%0A%20%20margin%3A%2028px%200%3B%0A%7D%0A%0Adl%20%7B%0A%20%20margin%2Dleft%3A%200%3B%0A%7D%0A%20%20dl%20dd%20%7B%0A%20%20%20%20margin%2Dbottom%3A%2013px%3B%0A%20%20%20%20margin%2Dleft%3A%2013px%3B%0A%20%20%7D%0A%20%20dl%20dt%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%7D%0A%0Aul%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%7D%0A%20%20ul%20li%20%7B%0A%20%20%20%20list%2Dstyle%3A%20circle%20outside%3B%0A%20%20%7D%0A%20%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dbottom%3A%200%3B%0A%20%20%7D%0A%0Apre%2C%20code%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20color%3A%20%23333%3B%0A%20%20white%2Dspace%3A%20pre%2Dwrap%3B%20%20%20%20%2F%2A%20Wrap%20long%20lines%20%2A%2F%0A%7D%0Apre%20%7B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20margin%3A%205px%200px%2010px%200px%3B%0A%20%20padding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Acode%20%7B%0A%20%20font%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0A%20%20font%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0A%20%20padding%3A%202px%200px%3B%0A%7D%0A%0Adiv%2Efigure%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0A%20%20background%2Dcolor%3A%20%23FFFFFF%3B%0A%20%20padding%3A%202px%3B%0A%20%20border%3A%201px%20solid%20%23DDDDDD%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20margin%3A%200%205px%3B%0A%7D%0A%0Ah1%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%20%20font%2Dsize%3A%2035px%3B%0A%20%20line%2Dheight%3A%2040px%3B%0A%7D%0A%0Ah2%20%7B%0A%20%20border%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20padding%2Dbottom%3A%202px%3B%0A%20%20font%2Dsize%3A%20145%25%3B%0A%7D%0A%0Ah3%20%7B%0A%20%20border%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20font%2Dsize%3A%20120%25%3B%0A%7D%0A%0Ah4%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0A%20%20margin%2Dleft%3A%208px%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Ah5%2C%20h6%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23ccc%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Aa%20%7B%0A%20%20color%3A%20%230033dd%3B%0A%20%20text%2Ddecoration%3A%20none%3B%0A%7D%0A%20%20a%3Ahover%20%7B%0A%20%20%20%20color%3A%20%236666ff%3B%20%7D%0A%20%20a%3Avisited%20%7B%0A%20%20%20%20color%3A%20%23800080%3B%20%7D%0A%20%20a%3Avisited%3Ahover%20%7B%0A%20%20%20%20color%3A%20%23BB00BB%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%0A%2F%2A%20Class%20described%20in%20https%3A%2F%2Fbenjeffrey%2Ecom%2Fposts%2Fpandoc%2Dsyntax%2Dhighlighting%2Dcss%0A%20%20%20Colours%20from%20https%3A%2F%2Fgist%2Egithub%2Ecom%2Frobsimmons%2F1172277%20%2A%2F%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Keyword%20%2A%2F%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%2F%2A%20DataType%20%2A%2F%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%2F%2A%20DecVal%20%28decimal%20values%29%20%2A%2F%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20BaseN%20%2A%2F%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Float%20%2A%2F%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Char%20%2A%2F%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20String%20%2A%2F%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%2F%2A%20Comment%20%2A%2F%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%2F%2A%20OtherToken%20%2A%2F%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20AlertToken%20%2A%2F%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Function%20calls%20%2A%2F%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%2F%2A%20ErrorTok%20%2A%2F%0A%0A" rel="stylesheet" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Examples demonstrating slcma R functions v0.5.R</h1>
<h4 class="author">Andrew Smith</h4>
<h4 class="date">15</h4>



<div id="getting-started" class="section level2">
<h2>Getting started</h2>
<p>Load the library.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(slcma)</code></pre>
<pre><code>## Loading required package: lars</code></pre>
<pre><code>## Loaded lars 1.3</code></pre>
<pre><code>## Loading required package: selectiveInference</code></pre>
<pre><code>## Loading required package: glmnet</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## Loaded glmnet 3.0-2</code></pre>
<pre><code>## Loading required package: intervals</code></pre>
<pre><code>## 
## Attaching package: 'intervals'</code></pre>
<pre><code>## The following object is masked from 'package:Matrix':
## 
##     expand</code></pre>
<pre><code>## Loading required package: survival</code></pre>
<pre><code>## Loading required package: adaptMCMC</code></pre>
<pre><code>## Loading required package: parallel</code></pre>
<pre><code>## Loading required package: coda</code></pre>
<pre><code>## Loading required package: MASS</code></pre>
<pre><code>## Loading required package: mice</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## 
## Attaching package: 'mice'</code></pre>
<pre><code>## The following objects are masked from 'package:base':
## 
##     cbind, rbind</code></pre>
<pre><code>## Loading required package: mvtnorm</code></pre>
</div>
<div id="example-1.-slcma" class="section level2">
<h2>Example 1. SLCMA</h2>
<p>Generate some data that matches that seen in Mishra et al (2009). This is the code I supplied in my 2015 Epidemiology paper.</p>
<pre class="sourceCode r"><code class="sourceCode r">N &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">141</span>,<span class="dv">20</span>,<span class="dv">88</span>,<span class="dv">80</span>,<span class="dv">40</span>,<span class="dv">35</span>,<span class="dv">317</span>,<span class="dv">367</span>)
BMI &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">28.7</span>,<span class="fl">27.5</span>,<span class="fl">29.1</span>,<span class="fl">27.8</span>,<span class="fl">28.3</span>,<span class="fl">27.1</span>,<span class="fl">27.6</span>,<span class="fl">26.0</span>)
SE &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">1.1</span>,<span class="fl">0.7</span>,<span class="fl">0.7</span>,<span class="fl">0.8</span>,<span class="fl">0.9</span>,<span class="fl">0.3</span>,<span class="fl">0.2</span>)
S1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)
S2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>)
S3 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)
x1 &lt;-<span class="st"> </span><span class="kw">rep</span>(S1,N)
x2 &lt;-<span class="st"> </span><span class="kw">rep</span>(S2,N)
x3 &lt;-<span class="st"> </span><span class="kw">rep</span>(S3,N)
epsilon &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="kw">sum</span>(N))
e &lt;-<span class="st"> </span><span class="kw">lm</span>(epsilon ~<span class="st"> </span>x1 *<span class="st"> </span>x2 *<span class="st"> </span>x3)$residuals
y &lt;-<span class="st"> </span><span class="kw">rep</span>(BMI,N) +<span class="st"> </span><span class="kw">rep</span>(SE*<span class="kw">sqrt</span>(N),N) *<span class="st"> </span>e/<span class="kw">sd</span>(e)</code></pre>
<p>As in my 2015 Epidemiology paper, perform SLCMA with 3 critical periods (early, middle, late)</p>
<ul>
<li><p>Accumulation</p></li>
<li><p>Early-middle mobility (up and down)</p></li>
<li><p>Middle-late mobility (up and down)</p></li>
</ul>
</div>
<div id="lars-stage-1" class="section level2">
<h2>LARS (stage 1)</h2>
<pre class="sourceCode r"><code class="sourceCode r">myslcma &lt;-
<span class="st">  </span><span class="kw">slcma</span>(y ~<span class="st"> </span>x1 +<span class="st"> </span>x2 +<span class="st"> </span>x3 +<span class="st"> </span><span class="kw">Accumulation</span>(x1,x2,x3) +<span class="st"> </span><span class="kw">Mobility</span>(x1,x2) +<span class="st"> </span><span class="kw">Mobility</span>(x2,x3))</code></pre>
<pre><code>##                      Term                             Role
##               (Intercept)       Adjusted for in all models
##                        x1 Available for variable selection
##                        x2 Available for variable selection
##                        x3 Available for variable selection
##  Accumulation(x1, x2, x3) Available for variable selection
##        Mobility(x1, x2)up Available for variable selection
##      Mobility(x1, x2)down Available for variable selection
##        Mobility(x2, x3)up Available for variable selection
##      Mobility(x2, x3)down Available for variable selection</code></pre>
<p>Get a summary of the SLMCA, to see what variables are added at which stage. This is more meaningful that the usual output of lars.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(myslcma)</code></pre>
<pre><code>## 
## Summary of LARS procedure
##  Step        Variable selected Variable removed Variables    R2
##     1 Accumulation(x1, x2, x3)                          1 0.023
##     2                       x1                          2 0.028
##     3     Mobility(x2, x3)down                          3 0.039
##     4                       x3                          4 0.039
##     5       Mobility(x1, x2)up                          5 0.040
##     6                                        x3         4 0.041
##     7     Mobility(x1, x2)down                          5 0.041</code></pre>
</div>
<div id="elbow-plots" class="section level2">
<h2>Elbow plots</h2>
<p>Default plot</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(myslcma)</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>For diagnostic purposes, can also show the part of the elbow plot after variables get removed and others added in.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(myslcma, <span class="dt">show.remove=</span><span class="ot">TRUE</span>, <span class="dt">show.labels=</span><span class="ot">FALSE</span>)</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Sometimes it is more helpful to show an alternative elbow plot with the R2 from the relaxed lasso.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(myslcma, <span class="dt">relax=</span><span class="ot">TRUE</span>)</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAADAFBMVEUAAAABAQECAgIDAwMEBAQFBQUGBgYHBwcICAgJCQkKCgoLCwsMDAwNDQ0ODg4PDw8QEBARERESEhITExMUFBQVFRUWFhYXFxcYGBgZGRkaGhobGxscHBwdHR0eHh4fHx8gICAhISEiIiIjIyMkJCQlJSUmJiYnJycoKCgpKSkqKiorKyssLCwtLS0uLi4vLy8wMDAxMTEyMjIzMzM0NDQ1NTU2NjY3Nzc4ODg5OTk6Ojo7Ozs8PDw9PT0+Pj4/Pz9AQEBBQUFCQkJDQ0NERERFRUVGRkZHR0dISEhJSUlKSkpLS0tMTExNTU1OTk5PT09QUFBRUVFSUlJTU1NUVFRVVVVWVlZXV1dYWFhZWVlaWlpbW1tcXFxdXV1eXl5fX19gYGBhYWFiYmJjY2NkZGRlZWVmZmZnZ2doaGhpaWlqampra2tsbGxtbW1ubm5vb29wcHBxcXFycnJzc3N0dHR1dXV2dnZ3d3d4eHh5eXl6enp7e3t8fHx9fX1+fn5/f3+AgICBgYGCgoKDg4OEhISFhYWGhoaHh4eIiIiJiYmKioqLi4uMjIyNjY2Ojo6Pj4+QkJCRkZGSkpKTk5OUlJSVlZWWlpaXl5eYmJiZmZmampqbm5ucnJydnZ2enp6fn5+goKChoaGioqKjo6OkpKSlpaWmpqanp6eoqKipqamqqqqrq6usrKytra2urq6vr6+wsLCxsbGysrKzs7O0tLS1tbW2tra3t7e4uLi5ubm6urq7u7u8vLy9vb2+vr6/v7/AwMDBwcHCwsLDw8PExMTFxcXGxsbHx8fIyMjJycnKysrLy8vMzMzNzc3Ozs7Pz8/Q0NDR0dHS0tLT09PU1NTV1dXW1tbX19fY2NjZ2dna2trb29vc3Nzd3d3e3t7f39/g4ODh4eHi4uLj4+Pk5OTl5eXm5ubn5+fo6Ojp6enq6urr6+vs7Ozt7e3u7u7v7+/w8PDx8fHy8vLz8/P09PT19fX29vb39/f4+Pj5+fn6+vr7+/v8/Pz9/f3+/v7////isF19AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAV1klEQVR4nO2dCXgURdqAa3LfN4ckgT9gCKDA6ghEF5FbQFCEHwkSOZRTkQ0IhOCNqEEQCKImGhARORJwAwSiBMGVQwRWUNAFDCyCqwuGM0AImaS2q+fqnkzX19U9kxkf6n0eZnq66+uqeZnudB1djTCHCvJ0AbwdLgiACwLgggC4IAAuCIALAuCCALggAC4IgAsC4IIAuCAALgiACwLgggC4IAAuCIALAuCCALggAC4IgAsC4IIAuCAALgiACwLgggC4IAAuCIALAuCCALggAC4IgAsC4IIAuCAALgiACwLgggC4IAAuCIALAuCCALggAC4IgAsC4IIAuCAALgiACwLgggC4IAAuCIALAuCCALggAC4IgAsC4IIAuCAALgiACwLgggC4IAAuCIALAuCCALggAE2Cis65uhjeiyZBaJuri+G9MAn6LN0M6pGe7q4CeRtMgjaHIGOqAGqdmuquAnkbbIfYUWPHY5gfYhRuZoa9zwVR+Sqx7+9cEI2LQ+O4IDqrM44pbZpqBGjuH5Ri/D+/wNuhhEq0jG+YkKI12E7n/7pNUMUFysbUjw4AfP24X5L/k7uhZMrs275Pe7AtOvl7twg6PatlKEKBt888qSToG2gXVbMDYxutZ8rVTvX6J5v7Id+m6auqdEa3c4ug70ISJ+Z8smLxpObRh5ynAAXtSIlbcfP1wH7/ZsnXQs2ShJQJS0v2fLF8UttGb1Xrim7rFkFd+143L1QP6+k8RdteZ/H8NMo/9Fi58H40yRdI5+xf3LD9tuW+o+/JhmMuvvbwvsMZPQtLnrhvfvPE5CmZnVukZQnrD9/n7xZBEeusSzujnKcwvlGF96+j/HvZ/L5vLJDO2b8c8b1sTK/RQ3reO7hf93sHk/c6/1LbpRqTGiVEhyEUFRGXdGfrlO59et435rH0gS9nPzf+gx3ivpq5RdA9T1uXXu3kPAX9EMs3ST7UfHqNJW8zNwt7NZiSk19A4/PSPQeOnDh94ZJjsOlkpfheKfwFc885aJ2h79I9/zq6d8Ug33XS9WWZVmL/Tot/rs2C3y2L5UvaTWA9i+BVxpCkvDmhKDGPNVKg+sVgFDyD/BctR+4ShIu7IYKh+xbZ6l+yrQS+Q40/ODSgzcisN2c92c7/kb1MOQv//6X3oihjcIb/lPynfFYzBgu85Td13RS/0ditgjC+cKS09IfzipvDPgTif18+smvbLukfnmHM99fspsbEEbW4GM0QPk3twBgu0DJLeFmJNrhZkIUbV52vBwVpoqZ0SOy473FICcbXEDmIS8LZdxK6mbymJ12vF0FpCnHuEER+PHnkhN5sofCykFyjLmvFvpsOU8nr2YbD60VQ3hjn60FB55/5a6qIyowsPx6RyeF5P5H32m+TnlQZLmEOmrj+BsabfdMz60GQEqCgwcEjp4mo2t1/spsZ82xHc0W6oSt574fa/Ie9aKasCFQmvG9qgtwriFpZBQVFLFedkfDjiRknr9JcOk5eNx4wOQ2AqDpxg7xVf5nrNkFgZRUSdBPtVJmV/Mdjxfq1dqjci2K0pyqr4C+ov6ruEPHHc9DJBv8XyI/gj5HazgySaPcIgiuroKCPGtyVNW++ACXNL68kpi5zXg9ZF99qV+2y2KTNYFmBaPcIgiuroKAEK842Xj24ds6ITjGxTyuX/kqGf+uAWdfhsgLR7hEEV1Y1XgdVnyjNm9yzeVDznpPzSk/UUlLqam+TRDMKipNASaxUWbWjRlDVL5X2Dxd25mUOMQbd1nNc9sYT8B8nPe1tsmhGQbm5uYvC4jMWPJ+SWExLrVBZtQMLKvqLDzK0K8IXDhRkP2EMizY+kV1wQHXDh2FEufB69P4QtQFK0eyH2IQHyBne1Gc8Pb3eyuoG9NCKTUMTUXhUh+GzV//zispiWrH0N9W+xxhXJ5pdULz5oClqoilrK6CgjkIlYXHnpf2NurLRjwZBi8S3xU115QsKChMOYWMp/lxDddylsAsaG7lJeC2OBA4xAFBQq7n4x3gTntdGVzb6YRdU0RXF3BmDuis09KgEFDQ76J1JWWeXBL+mKxv9aLkO2p6dMe9rnfmCgmqe8UM+yO9pbdVNK9cuVcKJqNGaLhRvlOnI1YyK66CVybkbT+vMJg0NePSyrug72AW9m2hAuMdizdmKqBA0nN6ur4q8MXiXQnVZZXRLZkFLDWNXIPyiQUuPih26oPxSnP9uyKJ8gq5s9MN+iLWZgsuFD9Pv1JUvXVBYGo4K8Y8S0bR7adefPtgFhWwRBW0J1ZCbveMwADpEL3X9jLyZtJxB5F1/+mAXdPfLoqDZ7TTkprrjUMgvRmz23B+hIRt5158+2AV95D/nG3RuacACXfnSD7H9AweipgMJdyRp2Lm864+VDdPsaLoOyokR6umBM2mNMTB0QQfT01E3cSj66B0adi7v+mOltAMKut2CBkE3T1Ve/Xbt9j/YM5YB/ZnfE6TcEgAi7/pjxnR/Z/sHZkE3ojU300mBBE18w/xe/pKGncu7/thZokcQnjlQ38FlBhBU1eCXVTPISaBfjIady7v+2DkjaeZjF1R4f/vMBYsEtGRtAxBU2ONVn/b+8am3ha7QtHtp158+2AU1tqIrX0DQwx8nZeIl6fh6R2rLrjJe3nEIQxd0LqoiaBM+3ALjIoVeEQjPdxwCZ0/oWp8uaNEI3OJtbAr6GX8dprJ8Dniw47BWxdkTvtanCzJuw5Mbr8adxpUN0TDAR8RzHYdqzp7wtT5VEGlrvTxoMN7pj/wLVJbPEQ91HAqoOXvC1/pUQTOyLAsXtp5SWTxHPNVxKKDm7Alf69ME1ST+S2WhlPFgx6Gasyd8rU8T9HnHJRJUls8BD3Ycqjl7wtf6NEHDl6gcAqCEvoH68uimzILUnD3ha32KoIpovTVhfQP15dGx2q6DwLMndK1PEbT0UZVFUkbPQH2HaC8cxNlVvI2jvxXmfEW0DtSvE80uSFXJdQziPBUn/vZGEQY29H1OZfncBbsgNSXXM4hz9iTJh6u9FcY4QszV1eUoidZ6iNFLrmcQZ8o+6aevkLYJZCINXfK0t0lKojWfg6gl1zGIc09L2cfNwdqa524UpYX6D1ij4VY8h2jNgqgl1zGIc8Kb5veVIoubdVVZvrpcW/toYNgTJcx348mj2QWpKbnSIM6fwY7DqgaWwz9IJCRVR63j2Ny2KNzQWP09Dc6iE9nrYmpKrjCI87S941ChClGo8aRch/3Pt0GNJ5RW/3usj4buZ3s08rI7DgfYWlEqDh8SYczXQgJqmrGzRtwP+kpXtHfdcXguqsKy9GkQMqMt36fNfwtNl7GpjP0sJIluxSxIUo9MgP/CMN5xuGikdalpl+KjIirL5wAyH1eauvZl0ewn6eU+SdMXZraIzMnNzYVbNBnvOLz7S+tS5G6VBXMC6drvo7lrXx7NLiitF/nJVveeyJ61BOeCSFurhYd09LuRrv3Bmrv25dHsgiwNvUXxUISGyur0WbbF3xIyVq8jqCyfA6k6uvZl0eyCmi4U3xbfRkutrbJak2C/dnjPoOsk7TLYBU2K2IjJQPKRlMQaK6ufSy67k4YdNYmoLJ8UMsTRit5odkGV/cWB5B0vUhJrrKw+Lrl6DAZnYFKGDHG0ojdaS11s74KMN0qof+G1VVYvR0naWlNfUVkwN6Oxsnq0hHoS1FZZXTpI8mFBwJC584F7VusDdkGne03D631RHK0OoO2OwwekU+ZQ71kF0NdrJI9mFzSwSRFu/+DJXtQmVy13HFraWl2Avl4jeTS7oJgP8G+oFK9qQE/PXlmd/azKotQr7IKi1uBlQZV4k8ZxKRacCErZL/2ks1fDZbAL6t1jd9tH8Lm+9+jKt66g3a1lH/X0anj2OuhQIxTxHU4O2MSetYS6gsa/6SSZtl4ND18HXT8gnFoKjrPnLCuFoyBbW6scrb0aLkPbddBM3aWuI6igl9N0Wns1MD6/a/1+7beN2qK1CUIam7Hs1BHU32HEms5ejZrnSItkVLbuaG8RdNbW1mpBZ6/GK4YZhy/+ONNH242RkmhvEbRwlN49ykk2T+01Q9ttf5JobYK2aeyxtOMo6K4vHVOczqnEx97+VeP+YzaIb8WReqPrdyC5YsfhkQTHdp8jYeFX8MHYqH1YEwPNLcLPdNMbzSqo4ovlB4S364e3PqQhY8WOw+nPOybtLTYpVQ7QcpI+dOjQ1ti0or1FwwxKdUHV0YyCfkoUzu4Tv08xCBVR9qwlyA8xaVurhWjzV/tCS78NkqA3mlHQgNhPfljdIP7eNVu/deXUFCV1W42SzeNTc5M17LxMgt5oRkEN5gov2Ujr8G47ckGPv1snwQtRhdW4ZmPMDM1ZyCaw0hzNKAitFV7WueCELRMka2u1YHrKx69xABqiZdJ+gnUCK73RrIJIA2GRqwXlD3KW5PiKOflqS1cHMoFV6cqHkbbbzSTRXiGoi7P/aH3XQR3Ns9yO0fZwKkm0Nwg6FefkONJ5HRRm/ulonMBKEs0qyF+oIPkjsZ6kKWtbESSCXnXW1qrnOgiLE1gR6BNY1ShNHSeJZhT0ggQoQnXfvLyt1YKe6yAsTmB1tlZ5Aqutox5biecqPhVAEu0FswHvau0sgZ7rIAxNYFWAWnWhPRVAEu0FswGPd9poA1wHySfYcMbpjcoTWN31JPRUAFu052cDrox1+jWA6yD5BBsOHJHgNJr6VAB5tOdnA17rvK0Vug6STbDhAFgXoz4VQFddTCUsffP9P6HtyaT4jLslyoL8UPvXvtplxmkC6lMB5NH1++gaOzZBddpaJdR+/UxDxXzPKLdknP+of2CDcV/cVExAfSqAPLp+H11jxyZogWJb694p8Siw/zKmfG1cWTU4JHpUsWJvP/2pAJJojz+65q7tTrd/l9kMBaPXaZMAQ9NzXFv/eETEcL3Rnr7j8EjTGidbX0hGIYPXXKWPkYen5/jjnRjFjWqjPX2hOK1OW6uYWdi7pD2OLgiYnuNcXk/fJpP+oTfawxeKTtpaCQ/4+PVffQ0QRJue4+z73X3jJ+909utkjPbwhWKJQnPEr293QOEjUZ2+IBmK03O81803MWM30GetMtrDF4rDlGdGKHvtDhT6WIFy07fy9BwItR83wYLeaM9eKF6OKqft5oesJBSsuFV5eo6/SNAbXb8Xio4dh8uctrVK2fs3xU0um56DSv1eKJ6xdRw2FP96fP8T0149gacuFOFHGXsJnnrGIRdkQemOw9SZeQLPPpJOI60XdXN6N/rmvv9P3Ty4Hz38IVLCvHgPPePww3GE5IataTQLoW5u7ZNC3RwRT93cJJK6uaWfWMTJaie0dst9W7Nep27eqdzkIxJBL3wa/Sm0H4+gbv6DcZC+iyurZm5dQWBl1cwtKwiurJq5ZQXBlVUzt6wguLJq5pYVBFdWzdyyguBeDTO3rCC4V8PMS29RN38DDO2IpY+TTKdPSrCK/qDsi4wziru4smrmGn3yj1ogntqYhPEl+rQvN4FrZGDvjnh6BgSvhwsC4IIAuCAALgiACwLgggC4IAAuCIALAuCCALggADcIWtchsttBaorSDcrbTG90CkuZp1gfrchICjUW0guw+TPFTZ+JrREKfVZOcb2gYsPEwj6htKnVTR0URtETstDU4pl+LyptTg9fuGUUUhxETDgakq64bX7DXAGWaXJdL6hbH4yvJ85S3H7mvS5IWVBVBLl1e2qwwjSCl8ijlmtTaNMV3DQiZUFP96BEOsXlgi6gpcLrhJaKCbZ07hykLOgEIqPD1iGFfqXjXcnAkS6PUQqQ2dGoLKjPOEqkU1wu6AjaI7zmUJ+IfLuyoBtlZJTqlGDKjbvXioMpo/i/CjuWqiyo5YN3h7b/gFY2R1wuaBsi4zc/QcoD7amCRFb6TVfeuNCAMpS3Xmz6PlYWVBMQm1M0BrHMUehyQaXiDCkrEK2Dmi7o3BNoFKVV9eTfp/vPVdw6tC+mCKpac0J4HRFBGybrgMsF/YDIU3cWB9LSUAVtaZgE3fU9JVTpG66O/Z0myMxniGFeApcLOm8gUyo924KWhiZos+9wSpP/xn5kHG8+UrqXIcNyv5OC4nMHxJ0ghucFuP7PfPdBGFc3z6QloQiqbqJ4GwbhACK3S49RnMfz2DaB1j22Kcw19h0it5CMb0bLwgHXC9ri+9qu4dHU4R8UQV+iGcsJCn/FTK2bL/98mg/9Qb2UQ+z+Jvklk31YZvt2Q1WjsGNkD3pVgyIo13KMKB0Ev45OCTN+Si8ARdD1jFbh95XQw+XwyioAFwTABQFwQQBcEAAXBMAFAXBBAFwQABcEwAUBcEEAXBAAFwTABQFwQQBcEAAXBMAFAXBBAFwQABcEwAUBcEEAXBAAFwRQD4JWIvOkfovRz/INYZIH8ZUh61QFcaofEeo05cE603znanikpp16EFQR8oz43u1uhw1ppfZllwlKH+i4xusF4aGNyHincl/5DNxVsklrb2lBG9AO4XUZOomv/O32oOZkPvrGhVnRp6KEQ8y6pgyVPhrT8tUay9debgy9k8yH+32f6NhHLWOubcvWjbKUppdSonsfwakIoUu2lVfHJyRMXOT1gqqiydjnAR0wHtR4/sYZZL75xvc/UlhJBFnXlKHY8UVTDc+Zv/Zi/5e2ZBjew9cbdV+d18Q8dbdt2bpRlhI/Ffnu5j5hp88P7vPfWtvKbhELCh8I83pBeExDE64ImofxYDJpQvsZgqB2tRgTQdY1ZWiosDA96AL52ldj5wgfxibiA2g3xkXm0UTWZdtGWcrjPgUYXwvLIYeYbeV2tBHjG/HeL2g7+hIXmB+tZDqyxF/4wo3JEL2ofPuaMnFY4WG0i3ztb9E35eXlKww3ysPbfvSbZSfWZdtGWcoVfmRg7JVKIsi2MjuGBGZ4v6CaJuPxMDK9665OwS2GxxNBC7BZkHVNmTg49iJaT772Wssws5/xPwcEobss96ZYlu0bpSnnWGecEATZVmaIj0Jc4P2C8JS4axGCkgv+Y49jnEoELcKiINsa8y/oR7SffO3tksfUXt/6oO8x6bJ9ozRlfgD5S3nwGBFkWzlP/AU9/ycQtB9lGM5gvJUMUK68TSLItqYMPS6syYq6Sr72uUByv8eLPXBBsvBVTyJxUKF12bZRlvIQ2kQeVfE2EWRb+Q/yHChTqz+BIJzs81fh9ZT/kJ0bOoX2K7cJsq0pQ4ZnN2f6ZJv/NmUGzNky3ZCDjwf0K17dO06cDMW2bN0oS4mHxH5Q+nDkr3j0HQdMtpXdIt/Z0DfxzyDoZZRD3ta0DO246ePol2yCbGvK0JaukW3IWvK1a+ffGdKajPXdZAyN62e5hLQu2zbKUlZNaxH+wD6MdySFX7atrBiXeNu44j+DoD8vXBAAFwTABQFwQQBcEAAXBMAFAXBBAFwQABcEwAUBcEEAXBAAFwTABQFwQQBcEAAXBMAFAXBBAFwQABcEwAUBcEEA/wO8uhBvFUyVjQAAAABJRU5ErkJggg==" /><!-- --></p>
<p>Can add your own labels to the elbow plot</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(myslcma, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Early critical period&quot;</span>,<span class="st">&quot;Middle critical period&quot;</span>,<span class="st">&quot;Late critical period&quot;</span>,
                         <span class="st">&quot;Accumulation&quot;</span>,<span class="st">&quot;Early-middle mobility (up)&quot;</span>,<span class="st">&quot;Early-middle mobility (down)&quot;</span>,
                         <span class="st">&quot;Middle-late mobility (up)&quot;</span>, <span class="st">&quot;Middle-late mobility (down)&quot;</span>))</code></pre>
<pre><code>##                         Label                     Term
##         Early critical period                       x1
##        Middle critical period                       x2
##          Late critical period                       x3
##                  Accumulation Accumulation(x1, x2, x3)
##    Early-middle mobility (up)       Mobility(x1, x2)up
##  Early-middle mobility (down)     Mobility(x1, x2)down
##     Middle-late mobility (up)       Mobility(x2, x3)up
##   Middle-late mobility (down)     Mobility(x2, x3)down</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Or if you can't remember all the variable names, and just want to label the ones that appear on the plot.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(myslcma, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Accumulation&quot;</span>,<span class="st">&quot;Early critical period&quot;</span>,<span class="st">&quot;Middle-late mobility (down)&quot;</span>,
                         <span class="st">&quot;Late critical period&quot;</span>, <span class="st">&quot;Early-middle mobility (up)&quot;</span>), <span class="dt">selection.order=</span><span class="ot">TRUE</span>)</code></pre>
<pre><code>##                        Label                     Term
##                 Accumulation Accumulation(x1, x2, x3)
##        Early critical period                       x1
##  Middle-late mobility (down)     Mobility(x2, x3)down
##         Late critical period                       x3
##   Early-middle mobility (up)       Mobility(x1, x2)up
##                           x3                       x3
##         Mobility(x1, x2)down     Mobility(x1, x2)down</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The function provides a sanity check so you can compare the default labels with the user-defined labels.</p>
</div>
<div id="inference-stage-2" class="section level2">
<h2>Inference (stage 2)</h2>
<p>Maybe there is an elbow at Step 3, perform selective inference by default</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">slcmaInfer</span>(myslcma, <span class="dv">3</span>)</code></pre>
<pre><code>## Warning in lsfit(x, y, intercept = oo): 'X' matrix was collinear</code></pre>
<pre><code>## 
## Inference for model at Step 3 of LARS procedure
## 
## Number of selected variables: 3
## Lasso R-squared: 0.039
## 
## Results from fixed lasso inference (selective inference):
## 
## Standard deviation of noise (specified or estimated) sigma = 5.194
## 
## Testing results at lambda = 5.553, with alpha = 0.050
## 
##                            Coef P-value  CI.lo  CI.up LoTailArea UpTailArea
## x1                       -0.778   0.153 -1.699  0.824      0.024      0.025
## Accumulation(x1, x2, x3) -0.608   0.010 -1.234 -0.106      0.025      0.024
## Mobility(x2, x3)down      1.196   0.048 -0.262  2.182      0.025      0.025</code></pre>
<p>We have the option to report the results of the relaxed lasso instead</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">slcmaInfer</span>(myslcma, <span class="dv">3</span>, <span class="dt">method=</span><span class="st">&quot;relax&quot;</span>)</code></pre>
<pre><code>## 
## Inference for model at Step 3 of LARS procedure
## 
## Number of selected variables: 3
## Lasso R-squared: 0.039
## 
## Results from relaxed lasso:
## 
## Relaxed r-squared: 0.041
## 
##                                Coef        SE      CI.lo      CI.up
## x1                       -0.7781529 0.4606667 -1.6810430  0.1247373
## Accumulation(x1, x2, x3) -0.6082188 0.2300848 -1.0591768 -0.1572608
## Mobility(x2, x3)down      1.1962127 0.5024468  0.2114351  2.1809904</code></pre>
<p>We have the option of trying the max-|t| test, but only at Step 1.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">slcmaInfer</span>(myslcma, <span class="dv">1</span>, <span class="dt">method=</span><span class="st">&quot;maxt&quot;</span>)</code></pre>
<pre><code>## 
## Inference for model at Step 1 of LARS procedure
## 
## Number of selected variables: 1
## Lasso R-squared: 0.023
## 
## Results from max-|t| test:
## 
## Error standard deviation: 5.187 on 1079 degrees of freedom
## 
##                                Coef      P-value
## Accumulation(x1, x2, x3) -0.9641575 4.296006e-09
## 
## Message regarding calculation of P-value: Normal Completion
##  with estimated numeric absolute error: 2.077572e-09</code></pre>
<p>We can also get confidence intervals from the max-|t| test, but these are time-consuming so they are not produced by default</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">slcmaInfer</span>(myslcma, <span class="dv">1</span>, <span class="dt">method=</span><span class="st">&quot;maxt&quot;</span>, <span class="dt">do.maxtCI=</span><span class="ot">TRUE</span>)</code></pre>
<pre><code>## 
## Inference for model at Step 1 of LARS procedure
## 
## Number of selected variables: 1
## Lasso R-squared: 0.023
## 
## Results from max-|t| test:
## 
## Error standard deviation: 5.187 on 1079 degrees of freedom
## Confidence interval coverage 95.0 percent
## 
##                                Coef      P-value     CI.lo      CI.up
## Accumulation(x1, x2, x3) -0.9641575 4.296006e-09 -1.312647 -0.6431147
## 
## Message regarding calculation of P-value: Normal Completion
##  with estimated numeric absolute error: 2.077572e-09</code></pre>
<p>We have the option of Bayesian inference, to find the posterior probability of the first-selected variable being the most important</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">slcmaInfer</span>(myslcma, <span class="dv">1</span>, <span class="dt">method=</span><span class="st">&quot;Bayes&quot;</span>)</code></pre>
<pre><code>## 
## Inference for model at Step 1 of LARS procedure
## 
## Number of selected variables: 1
## Lasso R-squared: 0.023
## 
## Posterior probabilities:
##                                    
## x1                       0.01385771
## x2                       0.00000039
## x3                       0.00221395
## Accumulation(x1, x2, x3) 0.98392562
## Mobility(x1, x2)up       0.00000026
## Mobility(x1, x2)down     0.00000000
## Mobility(x2, x3)up       0.00000001
## Mobility(x2, x3)down     0.00000207</code></pre>
<p>It is possible to produce results for all inference methods</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">slcmaInfer</span>(myslcma, <span class="dv">1</span>, <span class="dt">method=</span><span class="kw">c</span>(<span class="st">&quot;selectiveInference&quot;</span>,<span class="st">&quot;relax&quot;</span>,<span class="st">&quot;maxt&quot;</span>,<span class="st">&quot;Bayes&quot;</span>))</code></pre>
<pre><code>## Warning in lsfit(x, y, intercept = oo): 'X' matrix was collinear</code></pre>
<pre><code>## 
## Inference for model at Step 1 of LARS procedure
## 
## Number of selected variables: 1
## Lasso R-squared: 0.023
## 
## Results from fixed lasso inference (selective inference):
## 
## Standard deviation of noise (specified or estimated) sigma = 5.194
## 
## Testing results at lambda = 18.578, with alpha = 0.050
## 
##                            Coef P-value  CI.lo  CI.up LoTailArea UpTailArea
## Accumulation(x1, x2, x3) -0.964       0 -1.271 -0.632      0.024      0.024
## 
## Results from max-|t| test:
## 
## Error standard deviation: 5.187 on 1079 degrees of freedom
## 
##                                Coef      P-value
## Accumulation(x1, x2, x3) -0.9641575 4.296006e-09
## 
## Message regarding calculation of P-value: Normal Completion
##  with estimated numeric absolute error: 2.077572e-09
## 
## Results from relaxed lasso:
## 
## Relaxed r-squared: 0.034
## 
##                                Coef        SE     CI.lo      CI.up
## Accumulation(x1, x2, x3) -0.9641575 0.1557265 -1.269376 -0.6589391
## 
## Posterior probabilities:
##                                    
## x1                       0.01385771
## x2                       0.00000039
## x3                       0.00221395
## Accumulation(x1, x2, x3) 0.98392562
## Mobility(x1, x2)up       0.00000026
## Mobility(x1, x2)down     0.00000000
## Mobility(x2, x3)up       0.00000001
## Mobility(x2, x3)down     0.00000207</code></pre>
</div>
<div id="example-2.-adjusting-for-covariates" class="section level2">
<h2>Example 2. Adjusting for covariates</h2>
<p>Generate some data (this is the code I supplied in my 2015 IJE paper).</p>
<pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span><span class="dv">400</span>
<span class="kw">set.seed</span>(<span class="dv">1234</span>)
covariate &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n)
x1 &lt;-<span class="st"> </span>covariate +<span class="st"> </span><span class="kw">rnorm</span>(n)
x2 &lt;-<span class="st"> </span>x1 +<span class="st"> </span><span class="kw">rnorm</span>(n)
x3 &lt;-<span class="st"> </span>x2 +<span class="st"> </span><span class="dv">2</span>*<span class="kw">rnorm</span>(n)
y &lt;-<span class="st"> </span><span class="dv">2</span>*covariate +<span class="st"> </span>x3 +<span class="st"> </span><span class="dv">3</span>*<span class="kw">rnorm</span>(n)</code></pre>
</div>
<div id="adjust-for-covariates-stage-1" class="section level2">
<h2>Adjust for covariates (stage 1)</h2>
<p>Add any covariates into the formula, then use the option adjust = a numeric vector containing the position(s) of covariate(s) in the formula. Here there is one covariate (called 'covariate') and it is in the 8th position after the ~. Hence adjust=8.</p>
<pre class="sourceCode r"><code class="sourceCode r">slcmaAdjust &lt;-
<span class="st">  </span><span class="kw">slcma</span>(y ~<span class="st"> </span>x1 +<span class="st"> </span>x2 +<span class="st"> </span>x3 +<span class="st"> </span><span class="kw">Accumulation</span>(x1,x2,x3) +<span class="st"> </span><span class="kw">Change</span>(x1,x2) +<span class="st"> </span><span class="kw">Change</span>(x2,x3) +<span class="st"> </span><span class="kw">Change</span>(x1,x3) +<span class="st"> </span>covariate,
        <span class="dt">adjust=</span><span class="dv">8</span>)</code></pre>
<pre><code>##                      Term                             Role
##               (Intercept)       Adjusted for in all models
##                        x1 Available for variable selection
##                        x2 Available for variable selection
##                        x3 Available for variable selection
##  Accumulation(x1, x2, x3) Available for variable selection
##            Change(x1, x2) Available for variable selection
##            Change(x2, x3) Available for variable selection
##            Change(x1, x3) Available for variable selection
##                 covariate       Adjusted for in all models</code></pre>
<p>The function provides a sanity check so you can check the variables have the desired roles</p>
<p>You can revisit the sanity check</p>
<pre class="sourceCode r"><code class="sourceCode r">slcmaAdjust$sanity</code></pre>
<pre><code>##                       Term                             Role
## 1              (Intercept)       Adjusted for in all models
## 2                       x1 Available for variable selection
## 3                       x2 Available for variable selection
## 4                       x3 Available for variable selection
## 5 Accumulation(x1, x2, x3) Available for variable selection
## 6           Change(x1, x2) Available for variable selection
## 7           Change(x2, x3) Available for variable selection
## 8           Change(x1, x3) Available for variable selection
## 9                covariate       Adjusted for in all models</code></pre>
<p>Can summarize and produce plots as before</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(slcmaAdjust) </code></pre>
<pre><code>## 
## Summary of LARS procedure
##  Step        Variable selected Variable removed Variables    R2
##     1                       x3                          1 0.316
##     2 Accumulation(x1, x2, x3)                          2 0.359
##     3           Change(x1, x2)                          3 0.360</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(slcmaAdjust)</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Can perform inference (stage 2) as before</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">slcmaInfer</span>(slcmaAdjust,<span class="dv">1</span>, <span class="dt">method=</span><span class="kw">c</span>(<span class="st">&quot;selectiveInference&quot;</span>,<span class="st">&quot;relax&quot;</span>,<span class="st">&quot;maxt&quot;</span>,<span class="st">&quot;Bayes&quot;</span>))</code></pre>
<pre><code>## Warning in lsfit(x, y, intercept = oo): 'X' matrix was collinear</code></pre>
<pre><code>## 
## Inference for model at Step 1 of LARS procedure
## 
## Number of selected variables: 1
## Lasso R-squared: 0.316
## 
## Results from fixed lasso inference (selective inference):
## 
## Standard deviation of noise (specified or estimated) sigma = 3.106
## 
## Testing results at lambda = 15.514, with alpha = 0.050
## 
##     Coef P-value CI.lo CI.up LoTailArea UpTailArea
## x3 0.964       0 0.835 1.093      0.024      0.024
## 
## Results from max-|t| test:
## 
## Error standard deviation: 3.094 on 391 degrees of freedom
## 
##         Coef P-value
## x3 0.9637339       0
## 
## Message regarding calculation of P-value: Normal Completion
##  with estimated numeric absolute error: 0.000000e+00
## 
## Results from relaxed lasso:
## 
## Relaxed r-squared: 0.357
## 
##         Coef         SE     CI.lo    CI.up
## x3 0.9637339 0.06493734 0.8364591 1.091009
## 
## Posterior probabilities:
##                                   
## x1                       0.0000000
## x2                       0.0000000
## x3                       0.9999993
## Accumulation(x1, x2, x3) 0.0000007
## Change(x1, x2)           0.0000000
## Change(x2, x3)           0.0000000
## Change(x1, x3)           0.0000000</code></pre>
</div>
<div id="example-3.-covariates-and-missing-values" class="section level2">
<h2>Example 3. Covariates and missing values</h2>
<p>Some simulated data with missing values (this is the code I supplied to The Dunn Lab in 2016)</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">123</span>)
covariate &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">250</span>)
x1 &lt;-<span class="st"> </span>covariate +<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">250</span>)
x2 &lt;-<span class="st"> </span>x1 +<span class="st"> </span><span class="dv">2</span>*<span class="kw">rnorm</span>(<span class="dv">250</span>)
x3 &lt;-<span class="st"> </span>x2 +<span class="st"> </span><span class="dv">2</span>*<span class="kw">rnorm</span>(<span class="dv">250</span>)
y &lt;-<span class="st"> </span><span class="dv">2</span>*covariate +<span class="st"> </span><span class="dv">2</span>*(x3-x1) +<span class="st"> </span><span class="dv">5</span>*<span class="kw">rnorm</span>(<span class="dv">250</span>)
covariate[<span class="kw">sample</span>(<span class="dv">1</span>:<span class="dv">250</span>, <span class="dt">size=</span><span class="dv">10</span>)] &lt;-<span class="st"> </span><span class="ot">NA</span>
x1[<span class="kw">sample</span>(<span class="dv">1</span>:<span class="dv">250</span>, <span class="dt">size=</span><span class="dv">10</span>)] &lt;-<span class="st"> </span><span class="ot">NA</span>
x2[<span class="kw">sample</span>(<span class="dv">1</span>:<span class="dv">250</span>, <span class="dt">size=</span><span class="dv">10</span>)] &lt;-<span class="st"> </span><span class="ot">NA</span>
x3[<span class="kw">sample</span>(<span class="dv">1</span>:<span class="dv">250</span>, <span class="dt">size=</span><span class="dv">10</span>)] &lt;-<span class="st"> </span><span class="ot">NA</span>
y[<span class="kw">sample</span>(<span class="dv">1</span>:<span class="dv">250</span>, <span class="dt">size=</span><span class="dv">10</span>)] &lt;-<span class="st"> </span><span class="ot">NA</span>
incompleteData &lt;-<span class="st"> </span><span class="kw">data.frame</span>(covariate,x1,x2,x3,y)</code></pre>
<p>Complete case analysis</p>
<pre class="sourceCode r"><code class="sourceCode r">CCslcma &lt;-<span class="st"> </span><span class="kw">slcma</span>(y ~<span class="st"> </span>x1 +<span class="st"> </span>x2 +<span class="st"> </span>x3 +<span class="st"> </span><span class="kw">Accumulation</span>(x1,x2,x3) +<span class="st"> </span>
<span class="st">                 </span><span class="kw">Change</span>(x1,x3) +<span class="st"> </span><span class="kw">Ever</span>(x1,x2,x3) +<span class="st"> </span>covariate, incompleteData, <span class="dt">adjust=</span><span class="dv">7</span>)</code></pre>
<pre><code>##                      Term                             Role
##               (Intercept)       Adjusted for in all models
##                        x1 Available for variable selection
##                        x2 Available for variable selection
##                        x3 Available for variable selection
##  Accumulation(x1, x2, x3) Available for variable selection
##            Change(x1, x3) Available for variable selection
##          Ever(x1, x2, x3) Available for variable selection
##                 covariate       Adjusted for in all models</code></pre>
<p>Impute missing values (5 imputated datasets to save time)</p>
<pre class="sourceCode r"><code class="sourceCode r">imputedData &lt;-<span class="st"> </span><span class="kw">mice</span>(incompleteData, <span class="dt">m=</span><span class="dv">5</span>, <span class="dt">maxit=</span><span class="dv">20</span>, <span class="dt">seed=</span><span class="dv">321</span>)</code></pre>
<pre><code>## 
##  iter imp variable
##   1   1  covariate  x1  x2  x3  y
##   1   2  covariate  x1  x2  x3  y
##   1   3  covariate  x1  x2  x3  y
##   1   4  covariate  x1  x2  x3  y
##   1   5  covariate  x1  x2  x3  y
##   2   1  covariate  x1  x2  x3  y
##   2   2  covariate  x1  x2  x3  y
##   2   3  covariate  x1  x2  x3  y
##   2   4  covariate  x1  x2  x3  y
##   2   5  covariate  x1  x2  x3  y
##   3   1  covariate  x1  x2  x3  y
##   3   2  covariate  x1  x2  x3  y
##   3   3  covariate  x1  x2  x3  y
##   3   4  covariate  x1  x2  x3  y
##   3   5  covariate  x1  x2  x3  y
##   4   1  covariate  x1  x2  x3  y
##   4   2  covariate  x1  x2  x3  y
##   4   3  covariate  x1  x2  x3  y
##   4   4  covariate  x1  x2  x3  y
##   4   5  covariate  x1  x2  x3  y
##   5   1  covariate  x1  x2  x3  y
##   5   2  covariate  x1  x2  x3  y
##   5   3  covariate  x1  x2  x3  y
##   5   4  covariate  x1  x2  x3  y
##   5   5  covariate  x1  x2  x3  y
##   6   1  covariate  x1  x2  x3  y
##   6   2  covariate  x1  x2  x3  y
##   6   3  covariate  x1  x2  x3  y
##   6   4  covariate  x1  x2  x3  y
##   6   5  covariate  x1  x2  x3  y
##   7   1  covariate  x1  x2  x3  y
##   7   2  covariate  x1  x2  x3  y
##   7   3  covariate  x1  x2  x3  y
##   7   4  covariate  x1  x2  x3  y
##   7   5  covariate  x1  x2  x3  y
##   8   1  covariate  x1  x2  x3  y
##   8   2  covariate  x1  x2  x3  y
##   8   3  covariate  x1  x2  x3  y
##   8   4  covariate  x1  x2  x3  y
##   8   5  covariate  x1  x2  x3  y
##   9   1  covariate  x1  x2  x3  y
##   9   2  covariate  x1  x2  x3  y
##   9   3  covariate  x1  x2  x3  y
##   9   4  covariate  x1  x2  x3  y
##   9   5  covariate  x1  x2  x3  y
##   10   1  covariate  x1  x2  x3  y
##   10   2  covariate  x1  x2  x3  y
##   10   3  covariate  x1  x2  x3  y
##   10   4  covariate  x1  x2  x3  y
##   10   5  covariate  x1  x2  x3  y
##   11   1  covariate  x1  x2  x3  y
##   11   2  covariate  x1  x2  x3  y
##   11   3  covariate  x1  x2  x3  y
##   11   4  covariate  x1  x2  x3  y
##   11   5  covariate  x1  x2  x3  y
##   12   1  covariate  x1  x2  x3  y
##   12   2  covariate  x1  x2  x3  y
##   12   3  covariate  x1  x2  x3  y
##   12   4  covariate  x1  x2  x3  y
##   12   5  covariate  x1  x2  x3  y
##   13   1  covariate  x1  x2  x3  y
##   13   2  covariate  x1  x2  x3  y
##   13   3  covariate  x1  x2  x3  y
##   13   4  covariate  x1  x2  x3  y
##   13   5  covariate  x1  x2  x3  y
##   14   1  covariate  x1  x2  x3  y
##   14   2  covariate  x1  x2  x3  y
##   14   3  covariate  x1  x2  x3  y
##   14   4  covariate  x1  x2  x3  y
##   14   5  covariate  x1  x2  x3  y
##   15   1  covariate  x1  x2  x3  y
##   15   2  covariate  x1  x2  x3  y
##   15   3  covariate  x1  x2  x3  y
##   15   4  covariate  x1  x2  x3  y
##   15   5  covariate  x1  x2  x3  y
##   16   1  covariate  x1  x2  x3  y
##   16   2  covariate  x1  x2  x3  y
##   16   3  covariate  x1  x2  x3  y
##   16   4  covariate  x1  x2  x3  y
##   16   5  covariate  x1  x2  x3  y
##   17   1  covariate  x1  x2  x3  y
##   17   2  covariate  x1  x2  x3  y
##   17   3  covariate  x1  x2  x3  y
##   17   4  covariate  x1  x2  x3  y
##   17   5  covariate  x1  x2  x3  y
##   18   1  covariate  x1  x2  x3  y
##   18   2  covariate  x1  x2  x3  y
##   18   3  covariate  x1  x2  x3  y
##   18   4  covariate  x1  x2  x3  y
##   18   5  covariate  x1  x2  x3  y
##   19   1  covariate  x1  x2  x3  y
##   19   2  covariate  x1  x2  x3  y
##   19   3  covariate  x1  x2  x3  y
##   19   4  covariate  x1  x2  x3  y
##   19   5  covariate  x1  x2  x3  y
##   20   1  covariate  x1  x2  x3  y
##   20   2  covariate  x1  x2  x3  y
##   20   3  covariate  x1  x2  x3  y
##   20   4  covariate  x1  x2  x3  y
##   20   5  covariate  x1  x2  x3  y</code></pre>
<p>Apply LARS to data with same covariance structure as pooled data across imputations (data created via Cholesky decomposition)</p>
<pre class="sourceCode r"><code class="sourceCode r">MIslcma &lt;-<span class="st"> </span><span class="kw">slcma</span>(y ~<span class="st"> </span>x1 +<span class="st"> </span>x2 +<span class="st"> </span>x3 +<span class="st"> </span><span class="kw">Accumulation</span>(x1,x2,x3) +<span class="st"> </span>
<span class="st">                 </span><span class="kw">Change</span>(x1,x3) +<span class="st"> </span><span class="kw">Ever</span>(x1,x2,x3) +<span class="st"> </span>covariate, <span class="dt">data=</span>imputedData, <span class="dt">adjust=</span><span class="dv">7</span>)</code></pre>
<pre><code>##                      Term                             Role
##               (Intercept)       Adjusted for in all models
##                        x1 Available for variable selection
##                        x2 Available for variable selection
##                        x3 Available for variable selection
##          Ever(x1, x2, x3) Available for variable selection
##                 covariate       Adjusted for in all models
##  Accumulation(x1, x2, x3) Available for variable selection
##            Change(x1, x3) Available for variable selection</code></pre>
<p>Can summarize and produce plots as before</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(MIslcma) </code></pre>
<pre><code>## 
## Summary of LARS procedure
##  Step Variable selected Variable removed Variables    R2
##     1    Change(x1, x3)                          1 0.559
##     2                x2                          2 0.572
##     3                x1                          3 0.573
##     4  Ever(x1, x2, x3)                          4 0.573</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(MIslcma)</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Can perform inference (stage 2) as before</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">slcmaInfer</span>(MIslcma,<span class="dv">1</span>, <span class="dt">method=</span><span class="kw">c</span>(<span class="st">&quot;selectiveInference&quot;</span>,<span class="st">&quot;relax&quot;</span>,<span class="st">&quot;maxt&quot;</span>,<span class="st">&quot;Bayes&quot;</span>))</code></pre>
<pre><code>## Warning in lsfit(x, y, intercept = oo): 'X' matrix was collinear</code></pre>
<pre><code>## 
## Inference for model at Step 1 of LARS procedure
## 
## Number of selected variables: 1
## Lasso R-squared: 0.559
## 
## Results from fixed lasso inference (selective inference):
## 
## Standard deviation of noise (specified or estimated) sigma = 5.191
## 
## Testing results at lambda = 12.810, with alpha = 0.050
## 
##                 Coef P-value CI.lo CI.up LoTailArea UpTailArea
## Change(x1, x3) 2.056       0 1.832 2.282      0.025      0.024
## 
## Results from max-|t| test:
## 
## Error standard deviation: 5.180 on 242 degrees of freedom
## 
##                    Coef P-value
## Change(x1, x3) 2.056175       0
## 
## Message regarding calculation of P-value: Normal Completion
##  with estimated numeric absolute error: 0.000000e+00
## 
## Results from relaxed lasso:
## 
## Relaxed r-squared: 0.570
## 
##                    Coef        SE    CI.lo    CI.up
## Change(x1, x3) 2.056175 0.1139165 1.832902 2.279447
## 
## Posterior probabilities:
##                           
## x1                       0
## x2                       0
## x3                       0
## Ever(x1, x2, x3)         0
## Accumulation(x1, x2, x3) 0
## Change(x1, x3)           1</code></pre>
<p>Can recreate the dummy dataset used within the above SLCMA</p>
<pre class="sourceCode r"><code class="sourceCode r">myMIdata &lt;-<span class="st"> </span><span class="kw">MI2dummy</span>(y ~<span class="st"> </span>x1 +<span class="st"> </span>x2 +<span class="st"> </span>x3 +<span class="st"> </span><span class="kw">Accumulation</span>(x1,x2,x3) +<span class="st"> </span>
<span class="st">                     </span><span class="kw">Change</span>(x1,x3) +<span class="st"> </span><span class="kw">Ever</span>(x1,x2,x3) +<span class="st"> </span>covariate, imputedData)</code></pre>
<p>Note how sums, sums of squares and cross products are the same for <code>Accumulation(x1,x2,x3)</code> and <code>x1+x2+x3</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(myMIdata$<span class="st">`</span><span class="dt">Accumulation(x1, x2, x3)</span><span class="st">`</span>)</code></pre>
<pre><code>## [1] 32.59826</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(myMIdata$x1+myMIdata$x2+myMIdata$x3)</code></pre>
<pre><code>## [1] 32.59826</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(myMIdata$<span class="st">`</span><span class="dt">Accumulation(x1, x2, x3)</span><span class="st">`</span>^<span class="dv">2</span>)</code></pre>
<pre><code>## [1] 8859.746</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>((myMIdata$x1+myMIdata$x2+myMIdata$x3)^<span class="dv">2</span>)</code></pre>
<pre><code>## [1] 8859.746</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(myMIdata$x1 *<span class="st"> </span>myMIdata$<span class="st">`</span><span class="dt">Accumulation(x1, x2, x3)</span><span class="st">`</span>)</code></pre>
<pre><code>## [1] 1348.248</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(myMIdata$x1 *<span class="st"> </span>(myMIdata$x1+myMIdata$x2+myMIdata$x3))</code></pre>
<pre><code>## [1] 1348.248</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(myMIdata$y *<span class="st"> </span>myMIdata$<span class="st">`</span><span class="dt">Accumulation(x1, x2, x3)</span><span class="st">`</span>)</code></pre>
<pre><code>## [1] 7587.368</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(myMIdata$y *<span class="st"> </span>(myMIdata$x1+myMIdata$x2+myMIdata$x3))</code></pre>
<pre><code>## [1] 7587.368</code></pre>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
